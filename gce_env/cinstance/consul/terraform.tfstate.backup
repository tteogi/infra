{
    "version": 1,
    "serial": 3,
    "modules": [
        {
            "path": [
                "root"
            ],
            "outputs": {
                "bootstrap": "104.197.128.65",
                "sub": "146.148.94.146,8.35.193.115,8.35.193.212"
            },
            "resources": {
                "google_compute_instance.bootstrap": {
                    "type": "google_compute_instance",
                    "depends_on": [
                        "template_file.bootstrap",
                        "template_file.bootstrap",
                        "template_file.env"
                    ],
                    "primary": {
                        "id": "consul-server-bootstrap",
                        "attributes": {
                            "can_ip_forward": "true",
                            "disk.#": "1",
                            "disk.0.auto_delete": "true",
                            "disk.0.device_name": "",
                            "disk.0.disk": "",
                            "disk.0.image": "buddyon-v20160626",
                            "disk.0.scratch": "false",
                            "disk.0.size": "200",
                            "disk.0.type": "",
                            "id": "consul-server-bootstrap",
                            "machine_type": "custom-1-2048",
                            "metadata.#": "1",
                            "metadata.sshKeys": "core: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDfuvpdY6YGFvxVrYg5bsSnwxdpvl3KOfYNkC72ilUcp4Ax+1pP75dalspRylB1D7rrL0xQR0hzKu+7nBcYmvw2EhJifH0ESm3ICKaw0yvy2At6X+UlzR3YhnmJ84+HfLNetdGpc+qRKRR6FZqiO5fUw8Lyp+SAsrWPFOOuHYObUmcLrkJl0Ii/3oEjyWgAXtTcIKn4Iu+utGzmipwmOam0LoWhIrhoF7CBmM1mccSblJ1pCKgGcSyHUb0WwL/Yi1Fh6Vm2VW2g71VydCvr5VEPylsNWd9zoNxEAzUpUM9E4JBfkfLl9bsPReKDvGc0pyLRL6g/23Px2M1C+YlQ40z5 ubuntu@ubuntu-xenial",
                            "metadata_fingerprint": "aunfj1uLy98=",
                            "name": "consul-server-bootstrap",
                            "network.#": "0",
                            "network_interface.#": "1",
                            "network_interface.0.access_config.#": "1",
                            "network_interface.0.access_config.0.assigned_nat_ip": "104.197.128.65",
                            "network_interface.0.access_config.0.nat_ip": "",
                            "network_interface.0.address": "10.128.0.2",
                            "network_interface.0.name": "nic0",
                            "network_interface.0.network": "default",
                            "network_interface.0.subnetwork": "",
                            "self_link": "https://www.googleapis.com/compute/v1/projects/buddyon-1354/zones/us-central1-a/instances/consul-server-bootstrap",
                            "service_account.#": "0",
                            "tags.#": "1",
                            "tags.3217214002": "consul",
                            "tags_fingerprint": "MmxraX72Rqk=",
                            "zone": "us-central1-a"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "google_compute_instance.sub.0": {
                    "type": "google_compute_instance",
                    "depends_on": [
                        "google_compute_instance.bootstrap",
                        "template_file.env",
                        "template_file.sub",
                        "template_file.sub"
                    ],
                    "primary": {
                        "id": "consul-sub0-server",
                        "attributes": {
                            "can_ip_forward": "true",
                            "disk.#": "1",
                            "disk.0.auto_delete": "true",
                            "disk.0.device_name": "",
                            "disk.0.disk": "",
                            "disk.0.image": "buddyon-v20160626",
                            "disk.0.scratch": "false",
                            "disk.0.size": "200",
                            "disk.0.type": "",
                            "id": "consul-sub0-server",
                            "machine_type": "custom-1-2048",
                            "metadata.#": "1",
                            "metadata.sshKeys": "core: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDfuvpdY6YGFvxVrYg5bsSnwxdpvl3KOfYNkC72ilUcp4Ax+1pP75dalspRylB1D7rrL0xQR0hzKu+7nBcYmvw2EhJifH0ESm3ICKaw0yvy2At6X+UlzR3YhnmJ84+HfLNetdGpc+qRKRR6FZqiO5fUw8Lyp+SAsrWPFOOuHYObUmcLrkJl0Ii/3oEjyWgAXtTcIKn4Iu+utGzmipwmOam0LoWhIrhoF7CBmM1mccSblJ1pCKgGcSyHUb0WwL/Yi1Fh6Vm2VW2g71VydCvr5VEPylsNWd9zoNxEAzUpUM9E4JBfkfLl9bsPReKDvGc0pyLRL6g/23Px2M1C+YlQ40z5 ubuntu@ubuntu-xenial",
                            "metadata_fingerprint": "aunfj1uLy98=",
                            "name": "consul-sub0-server",
                            "network.#": "0",
                            "network_interface.#": "1",
                            "network_interface.0.access_config.#": "1",
                            "network_interface.0.access_config.0.assigned_nat_ip": "146.148.94.146",
                            "network_interface.0.access_config.0.nat_ip": "",
                            "network_interface.0.address": "10.128.0.4",
                            "network_interface.0.name": "nic0",
                            "network_interface.0.network": "default",
                            "network_interface.0.subnetwork": "",
                            "self_link": "https://www.googleapis.com/compute/v1/projects/buddyon-1354/zones/us-central1-a/instances/consul-sub0-server",
                            "service_account.#": "0",
                            "tags.#": "1",
                            "tags.3217214002": "consul",
                            "tags_fingerprint": "MmxraX72Rqk=",
                            "zone": "us-central1-a"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "google_compute_instance.sub.1": {
                    "type": "google_compute_instance",
                    "depends_on": [
                        "google_compute_instance.bootstrap",
                        "template_file.env",
                        "template_file.sub",
                        "template_file.sub"
                    ],
                    "primary": {
                        "id": "consul-sub1-server",
                        "attributes": {
                            "can_ip_forward": "true",
                            "disk.#": "1",
                            "disk.0.auto_delete": "true",
                            "disk.0.device_name": "",
                            "disk.0.disk": "",
                            "disk.0.image": "buddyon-v20160626",
                            "disk.0.scratch": "false",
                            "disk.0.size": "200",
                            "disk.0.type": "",
                            "id": "consul-sub1-server",
                            "machine_type": "custom-1-2048",
                            "metadata.#": "1",
                            "metadata.sshKeys": "core: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDfuvpdY6YGFvxVrYg5bsSnwxdpvl3KOfYNkC72ilUcp4Ax+1pP75dalspRylB1D7rrL0xQR0hzKu+7nBcYmvw2EhJifH0ESm3ICKaw0yvy2At6X+UlzR3YhnmJ84+HfLNetdGpc+qRKRR6FZqiO5fUw8Lyp+SAsrWPFOOuHYObUmcLrkJl0Ii/3oEjyWgAXtTcIKn4Iu+utGzmipwmOam0LoWhIrhoF7CBmM1mccSblJ1pCKgGcSyHUb0WwL/Yi1Fh6Vm2VW2g71VydCvr5VEPylsNWd9zoNxEAzUpUM9E4JBfkfLl9bsPReKDvGc0pyLRL6g/23Px2M1C+YlQ40z5 ubuntu@ubuntu-xenial",
                            "metadata_fingerprint": "aunfj1uLy98=",
                            "name": "consul-sub1-server",
                            "network.#": "0",
                            "network_interface.#": "1",
                            "network_interface.0.access_config.#": "1",
                            "network_interface.0.access_config.0.assigned_nat_ip": "8.35.193.115",
                            "network_interface.0.access_config.0.nat_ip": "",
                            "network_interface.0.address": "10.128.0.5",
                            "network_interface.0.name": "nic0",
                            "network_interface.0.network": "default",
                            "network_interface.0.subnetwork": "",
                            "self_link": "https://www.googleapis.com/compute/v1/projects/buddyon-1354/zones/us-central1-a/instances/consul-sub1-server",
                            "service_account.#": "0",
                            "tags.#": "1",
                            "tags.3217214002": "consul",
                            "tags_fingerprint": "MmxraX72Rqk=",
                            "zone": "us-central1-a"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "google_compute_instance.sub.2": {
                    "type": "google_compute_instance",
                    "depends_on": [
                        "google_compute_instance.bootstrap",
                        "template_file.env",
                        "template_file.sub",
                        "template_file.sub"
                    ],
                    "primary": {
                        "id": "consul-sub2-server",
                        "attributes": {
                            "can_ip_forward": "true",
                            "disk.#": "1",
                            "disk.0.auto_delete": "true",
                            "disk.0.device_name": "",
                            "disk.0.disk": "",
                            "disk.0.image": "buddyon-v20160626",
                            "disk.0.scratch": "false",
                            "disk.0.size": "200",
                            "disk.0.type": "",
                            "id": "consul-sub2-server",
                            "machine_type": "custom-1-2048",
                            "metadata.#": "1",
                            "metadata.sshKeys": "core: ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDfuvpdY6YGFvxVrYg5bsSnwxdpvl3KOfYNkC72ilUcp4Ax+1pP75dalspRylB1D7rrL0xQR0hzKu+7nBcYmvw2EhJifH0ESm3ICKaw0yvy2At6X+UlzR3YhnmJ84+HfLNetdGpc+qRKRR6FZqiO5fUw8Lyp+SAsrWPFOOuHYObUmcLrkJl0Ii/3oEjyWgAXtTcIKn4Iu+utGzmipwmOam0LoWhIrhoF7CBmM1mccSblJ1pCKgGcSyHUb0WwL/Yi1Fh6Vm2VW2g71VydCvr5VEPylsNWd9zoNxEAzUpUM9E4JBfkfLl9bsPReKDvGc0pyLRL6g/23Px2M1C+YlQ40z5 ubuntu@ubuntu-xenial",
                            "metadata_fingerprint": "aunfj1uLy98=",
                            "name": "consul-sub2-server",
                            "network.#": "0",
                            "network_interface.#": "1",
                            "network_interface.0.access_config.#": "1",
                            "network_interface.0.access_config.0.assigned_nat_ip": "8.35.193.212",
                            "network_interface.0.access_config.0.nat_ip": "",
                            "network_interface.0.address": "10.128.0.3",
                            "network_interface.0.name": "nic0",
                            "network_interface.0.network": "default",
                            "network_interface.0.subnetwork": "",
                            "self_link": "https://www.googleapis.com/compute/v1/projects/buddyon-1354/zones/us-central1-a/instances/consul-sub2-server",
                            "service_account.#": "0",
                            "tags.#": "1",
                            "tags.3217214002": "consul",
                            "tags_fingerprint": "MmxraX72Rqk=",
                            "zone": "us-central1-a"
                        },
                        "meta": {
                            "schema_version": "2"
                        }
                    }
                },
                "null_resource.cluster.0": {
                    "type": "null_resource",
                    "depends_on": [
                        "google_compute_instance.bootstrap",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "template_file.env",
                        "template_file.server_address",
                        "template_file.server_address"
                    ],
                    "primary": {
                        "id": "5211993256034058129",
                        "attributes": {
                            "id": "5211993256034058129",
                            "triggers.#": "1",
                            "triggers.cluster_instance_ids": "consul-sub0-server,consul-sub1-server,consul-sub2-server"
                        }
                    }
                },
                "null_resource.cluster.1": {
                    "type": "null_resource",
                    "depends_on": [
                        "google_compute_instance.bootstrap",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "template_file.env",
                        "template_file.server_address",
                        "template_file.server_address"
                    ],
                    "primary": {
                        "id": "4690788323307580944",
                        "attributes": {
                            "id": "4690788323307580944",
                            "triggers.#": "1",
                            "triggers.cluster_instance_ids": "consul-sub0-server,consul-sub1-server,consul-sub2-server"
                        }
                    }
                },
                "null_resource.cluster.2": {
                    "type": "null_resource",
                    "depends_on": [
                        "google_compute_instance.bootstrap",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "google_compute_instance.sub",
                        "template_file.env",
                        "template_file.server_address",
                        "template_file.server_address"
                    ],
                    "primary": {
                        "id": "3927162204112848554",
                        "attributes": {
                            "id": "3927162204112848554",
                            "triggers.#": "1",
                            "triggers.cluster_instance_ids": "consul-sub0-server,consul-sub1-server,consul-sub2-server"
                        }
                    }
                },
                "template_file.bootstrap": {
                    "type": "template_file",
                    "primary": {
                        "id": "eaedddfa390ab94e29c36543d14bbb676a4ac1fde59a276eee92891d1a77ed9c",
                        "attributes": {
                            "id": "eaedddfa390ab94e29c36543d14bbb676a4ac1fde59a276eee92891d1a77ed9c",
                            "rendered": "{\r\n  \"datacenter\": buddyon,\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": consul-server-bootstrap,\r\n  \"server\": true,\r\n  \"bootstrap_expect\" : 3\r\n}",
                            "template": "{\r\n  \"datacenter\": ${datacenter},\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": ${node_name},\r\n  \"server\": true,\r\n  \"bootstrap_expect\" : ${server_count}\r\n}",
                            "vars.#": "3",
                            "vars.datacenter": "buddyon",
                            "vars.node_name": "consul-server-bootstrap",
                            "vars.server_count": "3"
                        }
                    }
                },
                "template_file.env": {
                    "type": "template_file",
                    "primary": {
                        "id": "baa4c2d21fb6b2a1e6fce3c835cea5a60eafbcc6f9d1949a754fb151c1c33d29",
                        "attributes": {
                            "id": "baa4c2d21fb6b2a1e6fce3c835cea5a60eafbcc6f9d1949a754fb151c1c33d29",
                            "rendered": "server.env",
                            "template": "server.env"
                        }
                    }
                },
                "template_file.server_address": {
                    "type": "template_file",
                    "primary": {
                        "id": "c8178a4c744d4e98d1e850ad3497f554dae102fba06bc5d4683ddabc253655dd",
                        "attributes": {
                            "id": "c8178a4c744d4e98d1e850ad3497f554dae102fba06bc5d4683ddabc253655dd",
                            "rendered": "#!/bin/bash\nfile_path=$1\nexclude_servers=$2\n\ninclude_servers=\"\"\nfor i in $@\ndo\n    if [ \"$exclude_servers\" != \"$i\" -a $file_path != $i ]; then\n        if [ $include_servers ]; then\n            include_servers+=\",\"\n        fi\n        include_servers+=\"\\\"$i\\\"\"\n    fi\ndone\n\nsed -i 's/\u0026join_servers\u0026/'$include_servers'/g' $file_path\n\necho $include_servers",
                            "template": "#!/bin/bash\nfile_path=$1\nexclude_servers=$2\n\ninclude_servers=\"\"\nfor i in $@\ndo\n    if [ \"$exclude_servers\" != \"$i\" -a $file_path != $i ]; then\n        if [ $include_servers ]; then\n            include_servers+=\",\"\n        fi\n        include_servers+=\"\\\"$i\\\"\"\n    fi\ndone\n\nsed -i 's/\u0026join_servers\u0026/'$include_servers'/g' $file_path\n\necho $include_servers"
                        }
                    }
                },
                "template_file.sub.0": {
                    "type": "template_file",
                    "primary": {
                        "id": "529c884a8a37c17fc1b1ca3f903123b01630dcd9634b74d53afb2642c2e66204",
                        "attributes": {
                            "id": "529c884a8a37c17fc1b1ca3f903123b01630dcd9634b74d53afb2642c2e66204",
                            "rendered": "{\r\n  \"datacenter\": buddyon,\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": consul-server-sub0,\r\n  \"server\": true,\r\n  \"start_join\" : [\u0026join_servers\u0026],\r\n  \"retry_join\" : [\u0026join_servers\u0026],\r\n  \"retry_interval\" : \"15s\"\r\n}",
                            "template": "{\r\n  \"datacenter\": ${datacenter},\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": ${node_name},\r\n  \"server\": true,\r\n  \"start_join\" : [\u0026join_servers\u0026],\r\n  \"retry_join\" : [\u0026join_servers\u0026],\r\n  \"retry_interval\" : \"15s\"\r\n}",
                            "vars.#": "2",
                            "vars.datacenter": "buddyon",
                            "vars.node_name": "consul-server-sub0"
                        }
                    }
                },
                "template_file.sub.1": {
                    "type": "template_file",
                    "primary": {
                        "id": "469eb5be02b1403a20208fd6c5fc9c46a3e7d497324b2bcd4a32f84e3b816202",
                        "attributes": {
                            "id": "469eb5be02b1403a20208fd6c5fc9c46a3e7d497324b2bcd4a32f84e3b816202",
                            "rendered": "{\r\n  \"datacenter\": buddyon,\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": consul-server-sub1,\r\n  \"server\": true,\r\n  \"start_join\" : [\u0026join_servers\u0026],\r\n  \"retry_join\" : [\u0026join_servers\u0026],\r\n  \"retry_interval\" : \"15s\"\r\n}",
                            "template": "{\r\n  \"datacenter\": ${datacenter},\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": ${node_name},\r\n  \"server\": true,\r\n  \"start_join\" : [\u0026join_servers\u0026],\r\n  \"retry_join\" : [\u0026join_servers\u0026],\r\n  \"retry_interval\" : \"15s\"\r\n}",
                            "vars.#": "2",
                            "vars.datacenter": "buddyon",
                            "vars.node_name": "consul-server-sub1"
                        }
                    }
                },
                "template_file.sub.2": {
                    "type": "template_file",
                    "primary": {
                        "id": "29b9fe45ba62cafcc8fd0ce505dde0b4bf729cad45cdf1c011800f2a4aded13c",
                        "attributes": {
                            "id": "29b9fe45ba62cafcc8fd0ce505dde0b4bf729cad45cdf1c011800f2a4aded13c",
                            "rendered": "{\r\n  \"datacenter\": buddyon,\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": consul-server-sub2,\r\n  \"server\": true,\r\n  \"start_join\" : [\u0026join_servers\u0026],\r\n  \"retry_join\" : [\u0026join_servers\u0026],\r\n  \"retry_interval\" : \"15s\"\r\n}",
                            "template": "{\r\n  \"datacenter\": ${datacenter},\r\n  \"data_dir\": \"/opt/datas/consul\",\r\n  \"log_level\": \"INFO\",\r\n  \"node_name\": ${node_name},\r\n  \"server\": true,\r\n  \"start_join\" : [\u0026join_servers\u0026],\r\n  \"retry_join\" : [\u0026join_servers\u0026],\r\n  \"retry_interval\" : \"15s\"\r\n}",
                            "vars.#": "2",
                            "vars.datacenter": "buddyon",
                            "vars.node_name": "consul-server-sub2"
                        }
                    }
                }
            }
        }
    ]
}
